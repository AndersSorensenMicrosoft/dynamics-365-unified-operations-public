---
# required metadata

title: Microsoft Dynamics 365 Finance + Operations (on-premises) automated diagnostics collection
description: This article explains how to quickly collect information required to troubleshoot issues in your environment.
author: faix
ms.date: 9/28/2023
ms.topic: article
ms.prod: dynamics-365 
ms.service:
ms.technology:

# optional metadata

# ms.search.form: [Operations AOT form name to tie this article to]
audience: IT Pro
# ms.devlang: 
ms.reviewer: johnmichalak
# ms.tgt_pltfrm: 
# ms.custom: [used by loc for topics migrated from the wiki]
ms.search.region: Global
# ms.search.industry: [leave blank for most, retail, public sector]
ms.author: osfaixat
ms.search.validFrom: 2023-09-28 
ms.dyn365.ops.version: Platform update 62
search.app:
  - financeandoperationsonprem-docs
---

# Microsoft Dynamics 365 Finance + Operations (on-premises) automated diagnostics collection

[!include [banner](../includes/banner.md)]

This article explains how to quickly collect information required to troubleshoot issues in your environment. The diagnostics collection uses a new set of PowerShell scripts that are available starting with Infrastructure Scripts version 2.19.0. For more information on updating your scripts, see [Update the Infrastructure Scripts](obtain-infrascripts-onprem.md#update-the-infrastructure-scripts).

The new scripts don't replace other scripts like Test-ADFSConfiguration.ps1 or Test-D365FOConfiguration.ps1. They're meant to complement them. Eventually, these other scripts will be updated to output information in a similar format to the new scripts.

These scripts collect information that's required to troubleshoot issues in your environment. These scripts don't perform any troubleshooting or remediation steps.

> [!IMPORTANT]
> These scripts collect information from your environment and conveniently package it for Microsoft to analyze. These scripts don't send any information to Microsoft. You must manually provide the information to Microsoft using a support ticket.

## Collect node specific diagnostics

When collecting information from a particular node, you can use the following command:
```powershell
.\Get-NodeSpecificDiagnostics.ps1
```

> [!NOTE]
> This script needs machine specific information to run. As such, it is part of the scripts that get exported as part of the Export-Scripts.ps1 and are pushed to the machine using the remoting scripts.

By default, this script creates a directory at the same level as the script called **Diagnostics**. This directory contains the following information:

- Event Tracing for Windows (ETW) events that have been exported. These contain any Dynamics 365 Finance + Operations (on-premises) related publishers. Additionally, a subset of Security and Application logs are exported.

- For all Service Fabric applications that are deployed on that node, any logs generated by the applications are exported. This also includes the latest health events that each application has generated in that node.

If you won't use remoting to collect information from multiple nodes, and you need to provide information from multiple nodes to Microsoft make sure you manually copy the **Diagnostics** directory from each node. Then, zip the directories into a single file and provide it to Microsoft.

### Collect node specific diagnostics using remoting

When collecting information from all nodes in your service fabric cluster, you can use the following command:
```powershell
.\Get-NodeSpecificDiagnostics-AllVMs.ps1 -ConfigurationFilePath .\ConfigTemplate.xml
```

This script invokes the **Get-NodeSpecificDiagnostics.ps1** script on each node in the cluster. The output the script generates is output to a directory called **Diagnostics** on each node. The output is collected from each node and placed in a directory called **Diagnostics** at the same level as the **Get-NodeSpecificDiagnostics-AllVMs.ps1**.

If you want to collect information from a subset of nodes, you can use the **-MachinesToCollectFrom** parameter. For example, if you want to collect information from nodes **Node1** and **Node2**, you can use the following command:
```powershell
.\Get-NodeSpecificDiagnostics-AllVMs.ps1 -ConfigurationFilePath .\ConfigTemplate.xml -MachinesToCollectFrom @("Node1", "Node2")
```

## Collect general diagnostics

When collecting general diagnostics information, you can use the following command:
```powershell
.\Get-GeneralDiagnostics.ps1 -ConfigurationFilePath .\ConfigTemplate.xml
```

This script isn't node specific and doesn't need to be run on each node or exported to each node. In order to collect as much information as possible, this script should be invoked on a node that belongs to the service fabric cluster. The account used to execute the script should have privileges to connect to your SQL server and FileShare server. The output of this script is placed in a directory called **Diagnostics** at the same level as the script.

The following information is collected:
- Information about your Service Fabric cluster.
- Information about your SQL Server version.
- Information from your SQL Server database related to deployment operations. No customer data is collected.
- Information from your file shares related to deployment operations. No customer data is collected.
- Information about your Infrastructure Scripts.

## Providing the diagnostics information to Microsoft

After you have collected the diagnostics information, you can provide it to Microsoft by using the following steps:

1. Create a new support request through [Microsoft Dynamics Lifecycle Services (LCS)](https://lcs.dynamics.com/v2).
1. Find the **Diagnostics** directory that was created by the scripts. Then, zip the directory.
1. When prompted by a support engineer to provide logs, upload the zip file to the secure file upload location that the support engineer provides.


[!include [footer-include](../../../includes/footer-banner.md)]
