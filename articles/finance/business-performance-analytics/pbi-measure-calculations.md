| MEASURE_NAME                                             | MEASURE_UNIQUE_NAME                                                   | MEASURE_CAPTION                                          | DESCRIPTION                                                                                                                                                                                                                              | EXPRESSION                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | MEASURE_IS_VISIBLE | MEASURE_NAME_SQL_COLUMN_NAME                             | MEASURE_UNQUALIFIED_CAPTION                              | MEASUREGROUP_NAME    | MEASURE_DISPLAY_FOLDER                     |
| -------------------------------------------------------- | --------------------------------------------------------------------- | -------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------ | -------------------------------------------------------- | -------------------------------------------------------- | -------------------- | ------------------------------------------ |
| Amount (Sales invoice total)                             | [Measures].[Amount (Sales invoice total)]                             | Amount (Sales invoice total)                             |                                                                                                                                                                                                                                          | SUM('Fact - Sales invoice'[Amount (Transaction)]) + SUM('Fact - Sales invoice'[Amount (Charge)]) + SUM('Fact - Sales invoice'[Tax amount (Transaction)])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Amount (Sales invoice total)                             | Amount (Sales invoice total)                             | Fact - Sales invoice | .Amounts                                   |
| Purchase sub-ledger beginning balance                    | [Measures].[Purchase sub-ledger beginning balance]                    | Purchase sub-ledger beginning balance                    | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR MaxBalanceAsOfDate = [MAX Balance as of date]<br>VAR PurchageLedgerInvoiceFilter =<br>    FILTER (<br>        VALUES( 'Fact - Purchase sub-ledger'[Key] ),<br>            VAR Amount = [Purchase sub-ledger amount]<br>            VAR PaidAmountSettled = [Purchase payment matching paid amount (Settled)]<br>            RETURN<br>        SWITCH (<br>            [Invoice Status Selection],<br>            "All", TRUE,<br>            "Closed", ( Amount == ( PaidAmountSettled ) ),<br>            "Open", ( Amount <> ( PaidAmountSettled ) )<br>        )<br>    )<br>VAR Result =<br>    CALCULATE (<br>        [Purchase sub-ledger amount] - [Purchase payment matching paid amount (Settled)],<br>        FILTER(<br>            VALUES( 'Dim - Date (Accounting)'[Date] ),<br>            'Dim - Date (Accounting)'[Date] <= MaxBalanceAsOfDate<br>        ),<br>        PurchageLedgerInvoiceFilter<br>    )<br>VAR ResultNoZeros = IF( Result = 0, BLANK(), Result )<br>RETURN<br>ResultNoZeros                                                                                                                                                                                                                                                                                                                                                                                                                                          | True               | Purchase sub-ledger beginning balance                    | Purchase sub-ledger beginning balance                    | Metrics              | Purchase Sub-Ledger                        |
| Purchase payment matching paid amount (Settled)          | [Measures].[Purchase payment matching paid amount (Settled)]          | Purchase payment matching paid amount (Settled)          | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR MaxAgingReportBalanceDate = [MAX Balance as of date]<br>VAR Result =<br>    CALCULATE (<br>        [Purchase payment matching paid amount],<br>        USERELATIONSHIP(<br>            'Fact - Purchase sub-ledger'[Key],<br>            'Fact - Purchase payment matching'[Document number key (Matching)]<br>        ),<br>        'Fact - Purchase sub-ledger'[Key] <> BLANK(),<br>        'Fact - Purchase payment matching'[Date (Payment Matching)] <= MaxAgingReportBalanceDate<br>    )<br>RETURN<br>    Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | True               | Purchase payment matching paid amount (Settled)          | Purchase payment matching paid amount (Settled)          | Metrics              | Purchase Payment Matching                  |
| Purchase sub-ledger amount                               | [Measures].[Purchase sub-ledger amount]                               | Purchase sub-ledger amount                               | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR CurrencySelection = [Currency selection]<br>VAR TransactionDefault = [Purchase sub-ledger amount (Transaction)]<br>VAR Result =<br>    SWITCH(TRUE(),<br>        CurrencySelection = "Transaction Currency", TransactionDefault,<br>        CurrencySelection = "Accounting Currency", [Purchase sub-ledger amount (Accounting)],<br>        CurrencySelection = "Reporting Currency", [Purchase sub-ledger amount (Reporting)],<br>        TransactionDefault<br>    )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | True               | Purchase sub-ledger amount                               | Purchase sub-ledger amount                               | Metrics              | Purchase Sub-Ledger                        |
| Purchase payment matching paid amount                    | [Measures].[Purchase payment matching paid amount]                    | Purchase payment matching paid amount                    | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR CurrencySelection = [Currency selection]<br>VAR TransactionDefault = [Purchase payment matching paid amount (Transaction)]<br>VAR Result =<br>    SWITCH(TRUE(),<br>        CurrencySelection = "Transaction Currency", TransactionDefault,<br>        CurrencySelection = "Accounting Currency", [Purchase payment matching paid amount (Accounting)],<br>        CurrencySelection = "Reporting Currency", [Purchase payment matching paid amount (Reporting)],<br>        TransactionDefault<br>    )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | True               | Purchase payment matching paid amount                    | Purchase payment matching paid amount                    | Metrics              | Purchase Payment Matching                  |
| Purchase sub-ledger cross filter                         | [Measures].[Purchase sub-ledger cross filter]                         | Purchase sub-ledger cross filter                         | Used to filter dimensional table columns (e.g. Ledger, Selling Party, Date (Accounting), etc. by only matching values in the corresponding Purchase Sub-Ledger fact table. Please in the visual-level filter well and set filter to = 1  | INT ( NOT ISEMPTY ('Fact - Purchase sub-ledger' ) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | True               | Purchase sub-ledger cross filter                         | Purchase sub-ledger cross filter                         | Metrics              | Misc\\.Cross-Filters                       |
| Purchase sub-ledger credit amount                        | [Measures].[Purchase sub-ledger credit amount]                        | Purchase sub-ledger credit amount                        | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR CurrencyType = [Currency selection]<br>VAR TransactionDefault = [Purchase sub-ledger credit amount (Transaction)]<br>VAR Result =<br>    SWITCH(TRUE(),<br>        CurrencyType = "Accounting Currency", TransactionDefault,<br>        CurrencyType = "Transaction Currency", [Purchase sub-ledger credit amount (Transaction)],<br>        CurrencyType = "Reporting Currency", [Purchase sub-ledger credit amount (Reporting)],<br>        TransactionDefault<br>    )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | True               | Purchase sub-ledger credit amount                        | Purchase sub-ledger credit amount                        | Metrics              | Purchase Sub-Ledger                        |
| Purchase general ledger cross filter                     | [Measures].[Purchase general ledger cross filter]                     | Purchase general ledger cross filter                     | Used to filter dimensional table columns (e.g. Ledger, Selling Party, Date (Accounting), etc. by only matching values in the corresponding Purchase Distribution fact table. Place in the visual-level filter well and set filter to = 1 | INT ( NOT ISEMPTY ('Fact - General ledger' ) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | True               | Purchase general ledger cross filter                     | Purchase general ledger cross filter                     | Metrics              | Misc\\.Cross-Filters                       |
| General ledger amount (Credit)                           | [Measures].[General ledger amount (Credit)]                           | General ledger amount (Credit)                           |                                                                                                                                                                                                                                          | CALCULATE(<br>        [General ledger amount],<br>        'Fact - General ledger'[Debit or credit] = "Credit",<br>        'Fact - General ledger'[Posting type] <> "None"<br>        )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | True               | General ledger amount (Credit)                           | General ledger amount (Credit)                           | Metrics              | General Ledger\\.Amount                    |
| General ledger amount                                    | [Measures].[General ledger amount]                                    | General ledger amount                                    | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR CurrencySelection = [Currency selection]<br>VAR TransactionDefault = [General ledger amount (Transaction)]<br>VAR Result =<br>    SWITCH(TRUE(),<br>        CurrencySelection = "Transaction", TransactionDefault,<br>        CurrencySelection = "Accounting", [General ledger amount (Accounting)],<br>        CurrencySelection = "Reporting", [General ledger amount (Reporting)],<br>        TransactionDefault<br>    )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | True               | General ledger amount                                    | General ledger amount                                    | Metrics              | General Ledger\\.Amount                    |
| General ledger amount (Absolute)                         | [Measures].[General ledger amount (Absolute)]                         | General ledger amount (Absolute)                         |                                                                                                                                                                                                                                          | ABS([General ledger amount])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | True               | General ledger amount (Absolute)                         | General ledger amount (Absolute)                         | Metrics              | General Ledger\\.Amount                    |
| General ledger amount (Debit)                            | [Measures].[General ledger amount (Debit)]                            | General ledger amount (Debit)                            |                                                                                                                                                                                                                                          | CALCULATE(<br>        [General ledger amount],<br>        'Fact - General ledger'[Debit or credit] = "Debit",<br>        'Fact - General ledger'[Posting type] <> "None"<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | True               | General ledger amount (Debit)                            | General ledger amount (Debit)                            | Metrics              | General Ledger\\.Amount                    |
| General ledger row count                                 | [Measures].[General ledger row count]                                 | General ledger row count                                 |                                                                                                                                                                                                                                          | COUNTROWS('Fact - General ledger')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | True               | General ledger row count                                 | General ledger row count                                 | Metrics              | General Ledger                             |
| General ledger amount (Year opening balance)             | [Measures].[General ledger amount (Year opening balance)]             | General ledger amount (Year opening balance)             |                                                                                                                                                                                                                                          | VAR MinDate =<br>    CALCULATE(<br>        MIN('Dim - Date (Accounting)'[Date]),<br>        'Dim - Date (Accounting)'[Date Key] <> -1<br>    )<br>VAR MinYear =<br>        CALCULATE(<br>        MIN('Dim - Date (Accounting)'[Year]),<br>        'Dim - Date (Accounting)'[Date Key] <> -1<br>    )<br>VAR BeginningOfFiscalYear =<br>    CALCULATE(<br>        MIN('Dim - Date (Accounting)'[Date]),<br>            REMOVEFILTERS('Dim - Date (Accounting)'),<br>            'Dim - Date (Accounting)'[Year] = MinYear,<br>            'Dim - Date (Accounting)'[Start of year flag] = "Yes"<br>    )<br>VAR CalcOne =<br>    CALCULATE(<br>        [General ledger amount],<br>            REMOVEFILTERS('Dim - Date (Accounting)'),<br>            'Dim - Date (Accounting)'[Year] = MinYear,<br>            'Fact - General ledger'[Posting type] = "None",<br>            'Dim - Date (Accounting)'[Start of year flag] = "Yes"<br>        )<br>VAR CalcTwo =<br>    CALCULATE(<br>        [General ledger amount],<br>            REMOVEFILTERS('Dim - Date (Accounting)'),<br>            'Fact - General ledger'[Posting type] <> "None",<br>            'Dim - Date (Accounting)'[Date] >= BeginningOfFiscalYear,<br>            'Dim - Date (Accounting)'[Date] < MinDate<br>        )<br>VAR Result = IF( CalcOne + CalcTwo = 0, BLANK(), CalcOne + CalcTwo )<br>VAR ResultNoZeros = IF( Result = 0, BLANK(), Result )<br>RETURN<br>ResultNoZeros | True               | General ledger amount (Year opening balance)             | General ledger amount (Year opening balance)             | Metrics              | General Ledger\\.Amount                    |
| General ledger amount (Transaction)                      | [Measures].[General ledger amount (Transaction)]                      | General ledger amount (Transaction)                      |                                                                                                                                                                                                                                          | SUM('Fact - General ledger'[Amount])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | True               | General ledger amount (Transaction)                      | General ledger amount (Transaction)                      | Metrics              | General ledger\\.Amount                    |
| General ledger amount (Accounting)                       | [Measures].[General ledger amount (Accounting)]                       | General ledger amount (Accounting)                       |                                                                                                                                                                                                                                          | SUM('Fact - General ledger'[Amount (Accounting)])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | True               | General ledger amount (Accounting)                       | General ledger amount (Accounting)                       | Metrics              | General ledger\\.Amount                    |
| General ledger amount (Reporting)                        | [Measures].[General ledger amount (Reporting)]                        | General ledger amount (Reporting)                        |                                                                                                                                                                                                                                          | SUM('Fact - General ledger'[Amount (Accounting)])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | True               | General ledger amount (Reporting)                        | General ledger amount (Reporting)                        | Metrics              | General ledger\\.Amount                    |
| General ledger amount (Prior year)                       | [Measures].[General ledger amount (Prior year)]                       | General ledger amount (Prior year)                       |                                                                                                                                                                                                                                          | CALCULATE(<br>        [General ledger amount],<br>        DATEADD( 'Dim - Date (Accounting)'[Date], -1, YEAR )<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | True               | General ledger amount (Prior year)                       | General ledger amount (Prior year)                       | Metrics              | General Ledger\\.Amount                    |
| General ledger amount (Budget usage %)                   | [Measures].[General ledger amount (Budget usage %)]                   | General ledger amount (Budget usage %)                   |                                                                                                                                                                                                                                          | VAR BudgetAmount = [Budget amount]<br>VAR GeneralLedgerAmount = [General ledger amount]<br>VAR Result =<br>    IF(<br>        AND( BudgetAmount, GeneralLedgerAmount ),<br>        DIVIDE( GeneralLedgerAmount, BudgetAmount ) \* 100,<br>        BLANK()<br>    )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | True               | General ledger amount (Budget usage %)                   | General ledger amount (Budget usage %)                   | Metrics              | General Ledger\\.Amount                    |
| Budget amount                                            | [Measures].[Budget amount]                                            | Budget amount                                            | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR CurrencySelection = [Currency selection]<br>VAR TransactionDefault = [Budget amount (Transaction)]<br>VAR Result =<br>    SWITCH(TRUE(),<br>        CurrencySelection = "Transaction", TransactionDefault,<br>        CurrencySelection = "Accounting", [Budget amount (Accounting)],<br>        CurrencySelection = "Reporting", BLANK(),<br>        TransactionDefault<br>    )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | True               | Budget amount                                            | Budget amount                                            | Metrics              | Budget                                     |
| Budget amount (Absolute)                                 | [Measures].[Budget amount (Absolute)]                                 | Budget amount (Absolute)                                 |                                                                                                                                                                                                                                          | ABS([Budget amount])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | True               | Budget amount (Absolute)                                 | Budget amount (Absolute)                                 | Metrics              | Budget                                     |
| Budget amount (Profit)                                   | [Measures].[Budget amount (Profit)]                                   | Budget amount (Profit)                                   |                                                                                                                                                                                                                                          | [Budget amount (Revenue)] - [Budget amount (Expense)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | True               | Budget amount (Profit)                                   | Budget amount (Profit)                                   | Metrics              | Budget                                     |
| Budget amount (Profit %)                                 | [Measures].[Budget amount (Profit %)]                                 | Budget amount (Profit %)                                 |                                                                                                                                                                                                                                          | DIVIDE( [Budget amount (Profit)], [Budget amount (Revenue)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | True               | Budget amount (Profit %)                                 | Budget amount (Profit %)                                 | Metrics              | Budget                                     |
| Budget row count                                         | [Measures].[Budget row count]                                         | Budget row count                                         |                                                                                                                                                                                                                                          | COUNTROWS('Fact - Budget')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | True               | Budget row count                                         | Budget row count                                         | Metrics              | Budget                                     |
| Budget amount (General ledger variance)                  | [Measures].[Budget amount (General ledger variance)]                  | Budget amount (General ledger variance)                  |                                                                                                                                                                                                                                          | VAR BudgetAmount = [Budget amount]<br>VAR GeneralLedgerAmount = [General ledger amount]<br>VAR Result =<br>    IF( AND( BudgetAmount, GeneralLedgerAmount ), BudgetAmount - GeneralLedgerAmount, BLANK() )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | True               | Budget amount (General ledger variance)                  | Budget amount (General ledger variance)                  | Metrics              | Budget;General Ledger                      |
| Budget amount (Revenue)                                  | [Measures].[Budget amount (Revenue)]                                  | Budget amount (Revenue)                                  |                                                                                                                                                                                                                                          | CALCULATE (<br>        [Budget amount],<br>        'Dim - General ledger account'[Type] = "Revenue"<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | True               | Budget amount (Revenue)                                  | Budget amount (Revenue)                                  | Metrics              | Budget                                     |
| Budget amount (Expense)                                  | [Measures].[Budget amount (Expense)]                                  | Budget amount (Expense)                                  |                                                                                                                                                                                                                                          | CALCULATE (<br>        [Budget amount],<br>        'Dim - General ledger account'[Type] = "Expense"<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | True               | Budget amount (Expense)                                  | Budget amount (Expense)                                  | Metrics              | Budget                                     |
| Budget amount (Prior year)                               | [Measures].[Budget amount (Prior year)]                               | Budget Amount (Prior-Year)                               |                                                                                                                                                                                                                                          | CALCULATE(<br>        [Budget amount],<br>        DATEADD( 'Dim - Date (Accounting)'[Date], -1, YEAR )<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | True               | Budget amount (Prior year)                               | Budget Amount (Prior-Year)                               | Metrics              | Budget                                     |
| Purchase invoice cross filter                            | [Measures].[Purchase invoice cross filter]                            | Purchase invoice cross filter                            | Used to filter dimensional table columns (e.g. Ledger, Selling Party, Date (Accounting), etc. by only matching values in the corresponding Purchase Invoice fact table. Please in the visual-level filter well and set filter to = 1     | INT ( NOT ISEMPTY ('Fact - Purchase invoice' ) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | True               | Purchase invoice cross filter                            | Purchase invoice cross filter                            | Metrics              | Misc\\.Cross-Filters                       |
| Purchase invoice amount (Total charge)                   | [Measures].[Purchase invoice amount (Total charge)]                   | Purchase invoice amount (Total charge)                   |                                                                                                                                                                                                                                          | [Purchase invoice amount (Line charge)] +<br>[Purchase invoice amount (Allocated charge)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | True               | Purchase invoice amount (Total charge)                   | Purchase invoice amount (Total charge)                   | Metrics              | Purchase Invoice\\.Amount                  |
| Purchase Invoice amount (Total tax)                      | [Measures].[Purchase Invoice amount (Total tax)]                      | Purchase Invoice amount (Total tax)                      |                                                                                                                                                                                                                                          | [Purchase invoice amount (Line tax)] +<br>[Purchase invoice amount (Allocated tax)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | True               | Purchase Invoice amount (Total tax)                      | Purchase Invoice amount (Total tax)                      | Metrics              | Purchase Invoice\\.Amount                  |
| Purchase invoice amount (Total)                          | [Measures].[Purchase invoice amount (Total)]                          | Purchase invoice amount (Total)                          |                                                                                                                                                                                                                                          | [Purchase invoice amount (Line)] +<br>[Purchase invoice amount (Line charge)] +<br>[Purchase invoice amount (Line tax)] +<br>[Purchase invoice amount (Allocated charge)] +<br>[Purchase invoice amount (Allocated tax)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Purchase invoice amount (Total)                          | Purchase invoice amount (Total)                          | Metrics              | Purchase Invoice\\.Amount                  |
| Purchase invoice amount (Line)                           | [Measures].[Purchase invoice amount (Line)]                           | Purchase invoice amount (Line)                           |                                                                                                                                                                                                                                          | SUM( 'Fact - Purchase invoice'[Amount (Line)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | True               | Purchase invoice amount (Line)                           | Purchase invoice amount (Line)                           | Metrics              | Purchase Invoice\\.Amount                  |
| Purchase invoice amount (Line tax)                       | [Measures].[Purchase invoice amount (Line tax)]                       | Purchase invoice amount (Line tax)                       |                                                                                                                                                                                                                                          | SUM('Fact - Purchase invoice'[Amount (Line tax)])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | True               | Purchase invoice amount (Line tax)                       | Purchase invoice amount (Line tax)                       | Metrics              | Purchase Invoice\\.Amount                  |
| Purchase invoice amount (Allocated tax)                  | [Measures].[Purchase invoice amount (Allocated tax)]                  | Purchase invoice amount (Allocated tax)                  |                                                                                                                                                                                                                                          | SUM( 'Fact - Purchase invoice'[Amount (Allocated tax)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Purchase invoice amount (Allocated tax)                  | Purchase invoice amount (Allocated tax)                  | Metrics              | Purchase Invoice\\.Amount                  |
| Purchase invoice amount (Line charge)                    | [Measures].[Purchase invoice amount (Line charge)]                    | Purchase invoice amount (Line charge)                    |                                                                                                                                                                                                                                          | SUM( 'Fact - Purchase invoice'[Amount (Line charge)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | True               | Purchase invoice amount (Line charge)                    | Purchase invoice amount (Line charge)                    | Metrics              | Purchase Invoice\\.Amount                  |
| Purchase invoice amount (Allocated charge)               | [Measures].[Purchase invoice amount (Allocated charge)]               | Purchase invoice amount (Allocated charge)               |                                                                                                                                                                                                                                          | SUM( 'Fact - Purchase invoice'[Amount (Allocated charge)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | True               | Purchase invoice amount (Allocated charge)               | Purchase invoice amount (Allocated charge)               | Metrics              | Purchase Invoice\\.Amount                  |
| Purchase invoice count                                   | [Measures].[Purchase invoice count]                                   | Purchase invoice count                                   | Distinct count of Purchase Invoice ID                                                                                                                                                                                                    | DISTINCTCOUNT('Fact - Purchase invoice'[Invoice number key])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | True               | Purchase invoice count                                   | Purchase invoice count                                   | Metrics              | Purchase Invoice                           |
| Purchase invoice selling party count                     | [Measures].[Purchase invoice selling party count]                     | Purchase invoice selling party count                     | Distinct count of Selling Party IDs                                                                                                                                                                                                      | DISTINCTCOUNT('Fact - Purchase invoice'[Selling party key])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | True               | Purchase invoice selling party count                     | Purchase invoice selling party count                     | Metrics              | Purchase Invoice                           |
| Purchase payment count                                   | [Measures].[Purchase payment count]                                   | Purchase payment count                                   | Row count of 'Fact - Purchase Payment'                                                                                                                                                                                                   | COUNTROWS( 'Fact - Purchase payment' )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | True               | Purchase payment count                                   | Purchase payment count                                   | Metrics              | Purchase Payment                           |
| Purchase payment amount (Matching cash discount)         | [Measures].[Purchase payment amount (Matching cash discount)]         | Purchase payment amount (Matching cash discount)         |                                                                                                                                                                                                                                          | CALCULATE (<br>    [Purchase payment matching amount (Cash discount)],<br>        USERELATIONSHIP(<br>        'Fact - Purchase payment'[Document number key (Matching)],<br>        'Fact - Purchase payment matching'[Document number key (Matching)]<br>        ),<br>    'Fact - Purchase payment'[Document number key (Matching)] <> BLANK()<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | True               | Purchase payment amount (Matching cash discount)         | Purchase payment amount (Matching cash discount)         | Metrics              | Purchase Payment;Purchase Payment Matching |
| Purchase payment count (Prior month)                     | [Measures].[Purchase payment count (Prior month)]                     | Purchase payment count (Prior month)                     |                                                                                                                                                                                                                                          | VAR CurrentDate = MIN('Dim - Date (Accounting)'[Date])<br>VAR CurrentMonth = MONTH( CurrentDate )<br>VAR CurrentYear = YEAR( CurrentDate )<br>VAR PriorMonth =<br>    IF( CurrentMonth = 1,<br>        DATE( CurrentYear -1, 12, 1 ),<br>        DATE( CurrentYear, CurrentMonth - 1, 1 )<br>    )<br>//Returns the prior month either in current year or previous year if January<br><br>VAR Result =<br>    CALCULATE(<br>        [Purchase payment count],<br>            FILTER( ALLSELECTED( 'Dim - Date (Accounting)' ),<br>            'Dim - Date (Accounting)'[Month year] = PriorMonth<br>            )<br>    )<br>//Calculates prior month value<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | True               | Purchase payment count (Prior month)                     | Purchase payment count (Prior month)                     | Metrics              | Purchase Payment\\.Time Intelligence       |
| Purchase payment count (Month-over-month)                | [Measures].[Purchase payment count (Month-over-month)]                | Purchase payment count (Month-over-month)                |                                                                                                                                                                                                                                          | VAR CM = [Purchase payment count]<br>VAR PM = [Purchase payment count (Prior month)]<br>VAR Result =<br>    IF( AND( CM <> BLANK(), PM <> BLANK() ), CM - PM, BLANK() )<br>    // Only subtracts current month from prior month if both are not blank<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | True               | Purchase payment count (Month-over-month)                | Purchase payment count (Month-over-month)                | Metrics              | Purchase Payment\\.Time Intelligence       |
| Purchase payment count (Month-over-month %)              | [Measures].[Purchase payment count (Month-over-month %)]              | Purchase payment count (Month-over-month %)              |                                                                                                                                                                                                                                          | DIVIDE( [Purchase payment count (Month-over-month)], [Purchase payment count (Prior month)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | True               | Purchase payment count (Month-over-month %)              | Purchase payment count (Month-over-month %)              | Metrics              | Purchase Payment\\.Time Intelligence       |
| Purchase payment amount                                  | [Measures].[Purchase payment amount]                                  | Purchase payment amount                                  |                                                                                                                                                                                                                                          | SUM('Fact - Purchase payment'[Amount (Purchase payment)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | True               | Purchase payment amount                                  | Purchase payment amount                                  | Metrics              | Purchase Payment                           |
| Purchase payment matching amount (Cash discount)         | [Measures].[Purchase payment matching amount (Cash discount)]         | Purchase payment matching amount (Cash discount)         |                                                                                                                                                                                                                                          | SUM('Fact - Purchase payment matching'[Amount (Cash discount)])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | True               | Purchase payment matching amount (Cash discount)         | Purchase payment matching amount (Cash discount)         | Metrics              | Purchase Payment Matching                  |
| Purchase sub-ledger debit amount                         | [Measures].[Purchase sub-ledger debit amount]                         | Purchase sub-ledger debit amount                         | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR CurrencyType = [Currency selection]<br>VAR TransactionDefault = [Purchase sub-ledger debit amount (Transaction)]<br>VAR Result =<br>    SWITCH(TRUE(),<br>        CurrencyType = "Accounting Currency", TransactionDefault,<br>        CurrencyType = "Transaction Currency", [Purchase sub-ledger debit amount (Transaction)],<br>        CurrencyType = "Reporting Currency", [Purchase sub-ledger debit amount (Accounting)],<br>        TransactionDefault<br>    )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | True               | Purchase sub-ledger debit amount                         | Purchase sub-ledger debit amount                         | Metrics              | Purchase Sub-Ledger                        |
| Purchase sub-ledger debit amount (Single currency Only)  | [Measures].[Purchase sub-ledger debit amount (Single currency Only)]  | Purchase sub-ledger debit amount (Single currency Only)  | Only returns values if the visual is filtered to a single currency, or is structured to provide values for each currency                                                                                                                 | IF(<br>        ISFILTERED( 'Dim - Currency'[Currency] ),<br>        [Purchase sub-ledger debit amount],<br>        BLANK()<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | True               | Purchase sub-ledger debit amount (Single currency Only)  | Purchase sub-ledger debit amount (Single currency Only)  | Metrics              | Purchase Sub-Ledger                        |
| Purchase sub-ledger credit amount (Single currency only) | [Measures].[Purchase sub-ledger credit amount (Single currency only)] | Purchase sub-ledger credit amount (Single currency only) | Only returns values if the visual is filtered to a single currency, or is structured to provide values for each currency                                                                                                                 | IF(<br>        ISFILTERED( 'Dim - Currency'[Currency] ),<br>        [Purchase sub-ledger credit amount],<br>        BLANK()<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | True               | Purchase sub-ledger credit amount (Single currency only) | Purchase sub-ledger credit amount (Single currency only) | Metrics              | Purchase Sub-Ledger                        |
| General ledger amount (Single currency only)             | [Measures].[General ledger amount (Single currency only)]             | General ledger amount (Single currency only)             | Only returns the numbers if the visual is filtered to a single currency, or is strucutred to provide values for each currency. Designed to be used with charts, rather than detail tables, since it runs slower than its parent measure  | IF(<br>        ISFILTERED( 'Dim - Currency'[Currency] ),<br>        [General ledger amount],<br>        BLANK()<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | General ledger amount (Single currency only)             | General ledger amount (Single currency only)             | Metrics              | General Ledger\\.Amount                    |
| Budget amount (General ledger variance %)                | [Measures].[Budget amount (General ledger variance %)]                | Budget amount (General ledger variance %)                |                                                                                                                                                                                                                                          | DIVIDE([Budget amount (General ledger variance)], [Budget amount] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | True               | Budget amount (General ledger variance %)                | Budget amount (General ledger variance %)                | Metrics              | Budget;General Ledger                      |
| Purchase order cross filter                              | [Measures].[Purchase order cross filter]                              | Purchase order cross filter                              | Used to filter dimensional table columns (e.g. Ledger, Selling Party, Date (Accounting), etc. by only matching values in the corresponding Purchase Order fact table. Please in the visual-level filter well and set filter to = 1       | INT ( NOT ISEMPTY ('Fact - Purchase order' ) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | True               | Purchase order cross filter                              | Purchase order cross filter                              | Metrics              | Misc\\.Cross-Filters                       |
| Purchase order count                                     | [Measures].[Purchase order count]                                     | Purchase order count                                     | Distinct count of Purchase Order ID                                                                                                                                                                                                      | DISTINCTCOUNT( 'Fact - Purchase order'[Number key] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | True               | Purchase order count                                     | Purchase order count                                     | Metrics              | Purchase Order                             |
| Purchase order amount (Line charge)                      | [Measures].[Purchase order amount (Line charge)]                      | Purchase order amount (Line charge)                      |                                                                                                                                                                                                                                          | SUM( 'Fact - Purchase order'[Amount (Line charge)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | True               | Purchase order amount (Line charge)                      | Purchase order amount (Line charge)                      | Metrics              | Purchase Order\\.Amount                    |
| Purchase order amount (Line discount)                    | [Measures].[Purchase order amount (Line discount)]                    | Purchase order amount (Line discount)                    |                                                                                                                                                                                                                                          | SUM( 'Fact - Purchase order'[Amount (Line discount)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | True               | Purchase order amount (Line discount)                    | Purchase order amount (Line discount)                    | Metrics              | Purchase Order\\.Amount                    |
| Purchase order amount (Line)                             | [Measures].[Purchase order amount (Line)]                             | Purchase order amount (Line)                             |                                                                                                                                                                                                                                          | SUM( 'Fact - Purchase order'[Amount (Line)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | True               | Purchase order amount (Line)                             | Purchase order amount (Line)                             | Metrics              | Purchase Order\\.Amount                    |
| Purchase order quantity (Line inventory)                 | [Measures].[Purchase order quantity (Line inventory)]                 | Purchase order quantity (Line inventory)                 |                                                                                                                                                                                                                                          | SUM( 'Fact - Purchase order'[Quantity (Line inventory)])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Purchase order quantity (Line inventory)                 | Purchase order quantity (Line inventory)                 | Metrics              | Purchase Order\\.Quantity                  |
| Purchase order quantity (Line remaining inventory)       | [Measures].[Purchase order quantity (Line remaining inventory)]       | Purchase order quantity (Line remaining inventory)       |                                                                                                                                                                                                                                          | SUM( 'Fact - Purchase order'[Quantity (Line remaining inventory)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | True               | Purchase order quantity (Line remaining inventory)       | Purchase order quantity (Line remaining inventory)       | Metrics              | Purchase Order\\.Quantity                  |
| Purchase order quantity (Line)                           | [Measures].[Purchase order quantity (Line)]                           | Purchase order quantity (Line)                           |                                                                                                                                                                                                                                          | SUM( 'Fact - Purchase order'[Quantity (Line)])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | True               | Purchase order quantity (Line)                           | Purchase order quantity (Line)                           | Metrics              | Purchase Order\\.Quantity                  |
| Sales sub-ledger cross filter                            | [Measures].[Sales sub-ledger cross filter]                            | Sales sub-ledger cross filter                            | Used to filter dimensional table columns (e.g. Ledger, Selling Party, Date (Accounting), etc. by only matching values in the corresponding Purchase Distribution fact table. Place in the visual-level filter well and set filter to = 1 | INT ( NOT ISEMPTY ('Fact - Sales sub-ledger' ) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | True               | Sales sub-ledger cross filter                            | Sales sub-ledger cross filter                            | Metrics              | Misc\\.Cross-Filters                       |
| Sales invoice cross filter                               | [Measures].[Sales invoice cross filter]                               | Sales invoice cross filter                               | Used to filter dimensional table columns (e.g. Ledger, Selling Party, Date (Accounting), etc. by only matching values in the corresponding Purchase Distribution fact table. Place in the visual-level filter well and set filter to = 1 | INT ( NOT ISEMPTY ('Fact - Sales invoice' ) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | True               | Sales invoice cross filter                               | Sales invoice cross filter                               | Metrics              | Misc\\.Cross-Filters                       |
| Purchase distribution cross filter                       | [Measures].[Purchase distribution cross filter]                       | Purchase distribution cross filter                       | Used to filter dimensional table columns (e.g. Ledger, Selling Party, Date (Accounting), etc. by only matching values in the corresponding Purchase Distribution fact table. Place in the visual-level filter well and set filter to = 1 | INT ( NOT ISEMPTY ('Fact - Purchase distribution' ) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | True               | Purchase distribution cross filter                       | Purchase distribution cross filter                       | Metrics              | Misc\\.Cross-Filters                       |
| Sales sub-ledger amount                                  | [Measures].[Sales sub-ledger amount]                                  | Sales sub-ledger amount                                  | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR CurrencySelection = [Currency selection]<br>VAR TransactionDefault = [Sales sub-ledger amount (Transaction)]<br>VAR Result =<br>    SWITCH(TRUE(),<br>        CurrencySelection = "Transaction Currency", TransactionDefault,<br>        CurrencySelection = "Accounting Currency", [Sales sub-ledger amount (Accounting)],<br>        CurrencySelection = "Reporting Currency", [Sales sub-ledger amount (Reporting)],<br>        TransactionDefault<br>    )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | True               | Sales sub-ledger amount                                  | Sales sub-ledger amount                                  | Metrics              | Sales Sub-Ledger                           |
| Sales sub-ledger beginning balance                       | [Measures].[Sales sub-ledger beginning balance]                       | Sales sub-ledger beginning balance                       | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR MaxBalanceAsOfDate = [MAX Balance as of date]<br>VAR SalesLedgerInvoiceFilter =<br>    FILTER (<br>        VALUES( 'Fact - Sales sub-ledger'[Key] ),<br>            VAR Amount = [Sales sub-ledger amount]<br>            VAR PaidAmountSettled = [Sales payment matching paid amount (Settled)]<br>            RETURN<br>        SWITCH (<br>            [Invoice Status Selection],<br>            "All", TRUE,<br>            "Closed", ( Amount == ( PaidAmountSettled ) ),<br>            "Open", ( Amount <> ( PaidAmountSettled ) )<br>        )<br>    )<br>VAR Result =<br>    CALCULATE (<br>        [Sales sub-ledger amount] - [Sales payment matching paid amount (Settled)],<br>        FILTER(<br>            VALUES( 'Dim - Date (Accounting)'[Date] ),<br>            'Dim - Date (Accounting)'[Date] <= MaxBalanceAsOfDate<br>        ),<br>        SalesLedgerInvoiceFilter<br>    )<br>VAR ResultNoZeros = IF( Result = 0, BLANK(), Result )<br>RETURN<br>ResultNoZeros                                                                                                                                                                                                                                                                                                                                                                                                                                                               | True               | Sales sub-ledger beginning balance                       | Sales sub-ledger beginning balance                       | Metrics              | Sales Sub-Ledger                           |
| Sales sub-ledger credit amount                           | [Measures].[Sales sub-ledger credit amount]                           | Sales sub-ledger credit amount                           | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR CurrencyType = [Currency selection]<br>VAR TransactionDefault = [Sales sub-ledger credit amount (Transaction)]<br>VAR Result =<br>    SWITCH(TRUE(),<br>        CurrencyType = "Accounting Currency", TransactionDefault,<br>        CurrencyType = "Transaction Currency", [Sales sub-ledger credit amount (Transaction)],<br>        CurrencyType = "Reporting Currency", [Sales sub-ledger credit amount (Reporting)],<br>        TransactionDefault<br>    )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Sales sub-ledger credit amount                           | Sales sub-ledger credit amount                           | Metrics              | Sales Sub-Ledger                           |
| Sales sub-ledger credit amount (Single currency only)    | [Measures].[Sales sub-ledger credit amount (Single currency only)]    | Sales sub-ledger credit amount (Single currency only)    | Only returns values if the visual is filtered to a single currency, or is structured to provide values for each currency                                                                                                                 | IF(<br>        ISFILTERED( 'Dim - Currency'[Currency] ),<br>        [Sales sub-ledger credit amount],<br>        BLANK()<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | True               | Sales sub-ledger credit amount (Single currency only)    | Sales sub-ledger credit amount (Single currency only)    | Metrics              | Sales Sub-Ledger                           |
| Sales sub-ledger debit amount                            | [Measures].[Sales sub-ledger debit amount]                            | Sales sub-ledger debit amount                            | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR CurrencyType = [Currency selection]<br>VAR TransactionDefault = [Sales sub-ledger debit amount  (Transaction)]<br>VAR Result =<br>    SWITCH(TRUE(),<br>        CurrencyType = "Accounting Currency", TransactionDefault,<br>        CurrencyType = "Transaction Currency", [Sales sub-ledger debit amount  (Transaction)],<br>        CurrencyType = "Reporting Currency", [Sales sub-ledger debit amount (Accounting)],<br>        TransactionDefault<br>    )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Sales sub-ledger debit amount                            | Sales sub-ledger debit amount                            | Metrics              | Sales Sub-Ledger                           |
| Sales sub-ledger debit amount (Single currency only)     | [Measures].[Sales sub-ledger debit amount (Single currency only)]     | Sales sub-ledger debit amount (Single currency only)     | Only returns values if the visual is filtered to a single currency, or is structured to provide values for each currency                                                                                                                 | IF(<br>        ISFILTERED( 'Dim - Currency'[Currency] ),<br>        [Sales sub-ledger debit amount],<br>        BLANK()<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | True               | Sales sub-ledger debit amount (Single currency only)     | Sales sub-ledger debit amount (Single currency only)     | Metrics              | Sales Sub-Ledger                           |
| Sales payment matching paid amount                       | [Measures].[Sales payment matching paid amount]                       | Sales payment matching paid amount                       | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR CurrencySelection = [Currency selection]<br>VAR TransactionDefault = [Sales payment matching paid amount (Transaction)]<br>VAR Result =<br>    SWITCH(TRUE(),<br>        CurrencySelection = "Transaction Currency", TransactionDefault,<br>        CurrencySelection = "Accounting Currency", [Sales payment matching paid amount (Accounting)],<br>        CurrencySelection = "Reporting Currency", [Sales payment matching paid amount  (Reporting)],<br>        TransactionDefault<br>    )<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Sales payment matching paid amount                       | Sales payment matching paid amount                       | Metrics              | Sales Payment Matching                     |
| Sales payment matching paid amount (Settled)             | [Measures].[Sales payment matching paid amount (Settled)]             | Sales payment matching paid amount (Settled)             | Defaults to transaction currency, but can be changed to either accounting or reporting currency when using the Currency Type (Field Parameter)                                                                                           | VAR MaxAgingReportBalanceDate = [MAX Balance as of date]<br>VAR Result =<br>    CALCULATE (<br>        [Sales payment matching paid amount],<br>        USERELATIONSHIP(<br>            'Fact - Sales sub-ledger'[Number key (Sales payment matching)],<br>            'Fact - Sales payment matching'[Number key (Sales payment matching)]<br>        ),<br>        'Fact - Sales sub-ledger'[Key] <> BLANK(),<br>        'Fact - Sales payment matching'[Date (Payment matching)] <= MaxAgingReportBalanceDate<br>    )<br>RETURN<br>    Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | True               | Sales payment matching paid amount (Settled)             | Sales payment matching paid amount (Settled)             | Metrics              | Sales Payment Matching                     |
| Sales payment matching amount (Cash discount)            | [Measures].[Sales payment matching amount (Cash discount)]            | Sales payment matching amount (Cash discount)            |                                                                                                                                                                                                                                          | SUM('Fact - Sales payment matching'[Amount (Cash discount)])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | True               | Sales payment matching amount (Cash discount)            | Sales payment matching amount (Cash discount)            | Metrics              | Sales Payment Matching                     |
| Sales payment count                                      | [Measures].[Sales payment count]                                      | Sales payment count                                      |                                                                                                                                                                                                                                          | COUNTROWS( 'Fact - Sales payment' )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | True               | Sales payment count                                      | Sales payment count                                      | Metrics              | Sales Payment                              |
| Sales payment amount                                     | [Measures].[Sales payment amount]                                     | Sales payment amount                                     |                                                                                                                                                                                                                                          | SUM( 'Fact - Sales payment'[Amount] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | True               | Sales payment amount                                     | Sales payment amount                                     | Metrics              | Sales Payment                              |
| Sales payment amount (Matching cash discount)            | [Measures].[Sales payment amount (Matching cash discount)]            | Sales payment amount (Matching cash discount)            |                                                                                                                                                                                                                                          | CALCULATE (<br>    [Sales payment matching amount (Cash discount)],<br>        USERELATIONSHIP(<br>        'Fact - Sales payment'[Number key (Sales payment matching)],<br>        'Fact - Sales payment matching'[Number key (Sales payment matching)]<br>        ),<br>    'Fact - Sales payment'[Number key (Sales payment matching)] <> BLANK()<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | True               | Sales payment amount (Matching cash discount)            | Sales payment amount (Matching cash discount)            | Metrics              | Sales Payment;Sales Payment Matching       |
| Sales payment count (Prior month)                        | [Measures].[Sales payment count (Prior month)]                        | Sales payment count (Prior month)                        |                                                                                                                                                                                                                                          | VAR CurrentDate = MIN('Dim - Date (Accounting)'[Date])<br>VAR CurrentMonth = MONTH( CurrentDate )<br>VAR CurrentYear = YEAR( CurrentDate )<br>VAR PriorMonth =<br>    IF( CurrentMonth = 1,<br>        DATE( CurrentYear -1, 12, 1 ),<br>        DATE( CurrentYear, CurrentMonth - 1, 1 )<br>    )<br>//Returns the prior month either in current year or previous year if January<br><br>VAR Result =<br>    CALCULATE(<br>        [Sales payment count],<br>            FILTER( ALLSELECTED( 'Dim - Date (Accounting)' ),<br>            'Dim - Date (Accounting)'[Month year] = PriorMonth<br>            )<br>    )<br>//Calculates prior month value<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | True               | Sales payment count (Prior month)                        | Sales payment count (Prior month)                        | Metrics              | Sales Payment\\.Time Intelligence          |
| Sales payment count (Month-over-month)                   | [Measures].[Sales payment count (Month-over-month)]                   | Sales payment count (Month-over-month)                   |                                                                                                                                                                                                                                          | VAR CM = [Sales payment count]<br>VAR PM = [Sales payment count (Prior month)]<br>VAR Result =<br>    IF( AND( CM <> BLANK(), PM <> BLANK() ), CM - PM, BLANK() )<br>    // Only subtracts current month from prior month if both are not blank<br>RETURN<br>Result                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | True               | Sales payment count (Month-over-month)                   | Sales payment count (Month-over-month)                   | Metrics              | Sales Payment\\.Time Intelligence          |
| Sales payment count (Month-over-month %)                 | [Measures].[Sales payment count (Month-over-month %)]                 | Sales payment count (Month-over-month %)                 |                                                                                                                                                                                                                                          | DIVIDE( [Sales payment count (Month-over-month)], [Sales payment count (Prior month)] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | True               | Sales payment count (Month-over-month %)                 | Sales payment count (Month-over-month %)                 | Metrics              | Sales Payment\\.Time Intelligence          |
| Sales sub-ledger row count                               | [Measures].[Sales sub-ledger row count]                               | Sales sub-ledger row count                               |                                                                                                                                                                                                                                          | COUNTROWS( 'Fact - Sales sub-ledger' )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | True               | Sales sub-ledger row count                               | Sales sub-ledger row count                               | Metrics              | Sales Sub-Ledger                           |
| Purchase sub-ledger row count                            | [Measures].[Purchase sub-ledger row count]                            | Purchase sub-ledger row count                            |                                                                                                                                                                                                                                          | COUNTROWS( 'Fact - Purchase sub-ledger' )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | True               | Purchase sub-ledger row count                            | Purchase sub-ledger row count                            | Metrics              | Purchase Sub-Ledger                        |
| Buying party account count                               | [Measures].[Buying party account count]                               | Buying party account count                               | Distinct count of<br>'Dim - Buying Party'[Account]                                                                                                                                                                                       | DISTINCTCOUNT( 'Dim - Buying party'[Account] )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | True               | Buying party account count                               | Buying party account count                               | Metrics              | Buying Party                               |
| 20% Vendors                                              | [Measures].[20% Vendors]                                              | 20% Vendors                                              |                                                                                                                                                                                                                                          | VAR total = [Amount Year 1]<br>VAR SummarizedTable =<br>    SUMMARIZE (<br>        FILTER (<br>            'Fact - Purchase distribution',<br>            RELATED ( 'Dim - Date (Accounting)'[Year] ) = ( '.Date parameter - Spend: compare from (Year 1)' )<br>        ),<br>        'Fact - Purchase distribution'[Selling Party Key],<br>        "Total Percentage", SUM ( 'Fact - Purchase distribution'[Amount (Purchase distribution)] ) / total,<br>        "Total Amount", SUM ( 'Fact - Purchase distribution'[Amount (Purchase distribution)] )<br>    )<br>VAR RankedTable =<br>    ADDCOLUMNS (<br>        SummarizedTable,<br>        "Ranking", RANKX ( SummarizedTable, [Total Percentage],, ASC, DENSE )<br>    )<br>VAR CumulativeTable =<br>    ADDCOLUMNS (<br>        RankedTable,<br>        "Cumulative",<br>            SUMX (<br>                FILTER ( ( RankedTable ), [Total Percentage] <= EARLIER ( [Total Percentage] ) ),<br>                [Total Percentage]<br>            )<br>    )<br>VAR counter =<br>    CALCULATE ( COUNTROWS ( FILTER ( CumulativeTable, [Cumulative] < 0.20 ) ) )<br>VAR FilteredMeasure =<br>    CALCULATE (<br>        SUMX ( FILTER ( CumulativeTable, [Ranking] <= counter ), [Total Amount] )<br>    )<br>RETURN<br>    IF ( ISBLANK ( FilteredMeasure ), 0, FilteredMeasure )                                                                                                              | True               | 20% Vendors                                              | 20% Vendors                                              | Metrics              | .Purchase distribution                     |
| 20% Vendors count                                        | [Measures].[20% Vendors count]                                        | 20% Vendors count                                        |                                                                                                                                                                                                                                          | VAR total = [Amount Year 1]<br>VAR SummarizedTable =<br>    SUMMARIZE (<br>        FILTER (<br>            'Fact - Purchase distribution',<br>            RELATED ( 'Dim - Date (Accounting)'[Year] ) = ( '.Date parameter - Spend: compare from (Year 1)' )<br>        ),<br>        'Fact - Purchase distribution'[Selling Party Key],<br>        "Total Percentage", SUM ( 'Fact - Purchase distribution'[Amount (Purchase distribution)] ) / total,<br>        "Total Amount", SUM ( 'Fact - Purchase distribution'[Amount (Purchase distribution)] )<br>    )<br>VAR RankedTable =<br>    ADDCOLUMNS (<br>        SummarizedTable,<br>        "Ranking", RANKX ( SummarizedTable, [Total Percentage],, ASC, DENSE )<br>    )<br>VAR CumulativeTable =<br>    ADDCOLUMNS (<br>        RankedTable,<br>        "Cumulative",<br>            SUMX (<br>                FILTER ( ( RankedTable ), [Total Percentage] <= EARLIER ( [Total Percentage] ) ),<br>                [Total Percentage]<br>            )<br>    )<br>VAR counter =<br>    CALCULATE ( COUNTROWS ( FILTER ( CumulativeTable, [Cumulative] < 0.20 ) ) )<br>RETURN<br>    IF ( ISBLANK ( counter ), 0, counter )                                                                                                                                                                                                                                                                        | True               | 20% Vendors count                                        | 20% Vendors count                                        | Metrics              | .Purchase distribution                     |
| 20% Vendors count with label                             | [Measures].[20% Vendors count with label]                             | 20% Vendors count with label                             |                                                                                                                                                                                                                                          | [20% Vendors count] & " vendors"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | True               | 20% Vendors count with label                             | 20% Vendors count with label                             | Metrics              | .Purchase distribution                     |
| 80% Vendors                                              | [Measures].[80% Vendors]                                              | 80% Vendors                                              |                                                                                                                                                                                                                                          | VAR total = [Amount Year 1]<br>VAR SummarizedTable =<br>    SUMMARIZE (<br>        FILTER (<br>            'Fact - Purchase distribution',<br>            RELATED ( 'Dim - Date (Accounting)'[Year] ) = ( '.Date parameter - Spend: compare from (Year 1)' )<br>        ),<br>        'Fact - Purchase distribution'[Selling Party Key],<br>        "Total Percentage", SUM ( 'Fact - Purchase distribution'[Amount (Purchase distribution)] ) / total,<br>        "Total Amount", SUM ( 'Fact - Purchase distribution'[Amount (Purchase distribution)] )<br>    )<br>VAR RankedTable =<br>    ADDCOLUMNS (<br>        SummarizedTable,<br>        "Ranking", RANKX ( SummarizedTable, [Total Percentage],, ASC, DENSE )<br>    )<br>VAR CumulativeTable =<br>    ADDCOLUMNS (<br>        RankedTable,<br>        "Cumulative",<br>            SUMX (<br>                FILTER ( ( RankedTable ), [Total Percentage] <= EARLIER ( [Total Percentage] ) ),<br>                [Total Percentage]<br>            )<br>    )<br>VAR counter =<br>    CALCULATE ( COUNTROWS ( FILTER ( CumulativeTable, [Cumulative] < 0.20 ) ) )<br>VAR FilteredMeasure =<br>    CALCULATE (<br>        SUMX ( FILTER ( CumulativeTable, [Ranking] > counter ), [Total Amount] )<br>    )<br>RETURN<br>    FilteredMeasure                                                                                                                                                      | True               | 80% Vendors                                              | 80% Vendors                                              | Metrics              | .Purchase distribution                     |
| 80% Vendors count                                        | [Measures].[80% Vendors count]                                        | 80% Vendors count                                        |                                                                                                                                                                                                                                          | VAR total = [Amount Year 1]<br>VAR SummarizedTable =<br>    SUMMARIZE (<br>        FILTER (<br>            'Fact - Purchase distribution',<br>            RELATED ( 'Dim - Date (Accounting)'[Year] ) = ( '.Date parameter - Spend: compare from (Year 1)' )<br>        ),<br>        'Fact - Purchase distribution'[Selling Party Key],<br>        "Total Percentage", SUM ( 'Fact - Purchase distribution'[Amount (Purchase distribution)] ) / total,<br>        "Total Amount", SUM ( 'Fact - Purchase distribution'[Amount (Purchase distribution)] )<br>    )<br>VAR RankedTable =<br>    ADDCOLUMNS (<br>        SummarizedTable,<br>        "Ranking", RANKX ( SummarizedTable, [Total Percentage],, ASC, DENSE )<br>    )<br>VAR CumulativeTable =<br>    ADDCOLUMNS (<br>        RankedTable,<br>        "Cumulative",<br>            SUMX (<br>                FILTER ( ( RankedTable ), [Total Percentage] <= EARLIER ( [Total Percentage] ) ),<br>                [Total Percentage]<br>            )<br>    )<br>VAR counter =<br>    CALCULATE (<br>        COUNTROWS ( CumulativeTable )<br>            - COUNTROWS ( FILTER ( CumulativeTable, [Cumulative] < 0.20 ) )<br>    )<br>RETURN<br>    counter                                                                                                                                                                                                                                      | True               | 80% Vendors count                                        | 80% Vendors count                                        | Metrics              | .Purchase distribution                     |
| 80% Vendors count with label                             | [Measures].[80% Vendors count with label]                             | 80% Vendors count with label                             |                                                                                                                                                                                                                                          | [80% Vendors count] & " vendors"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | True               | 80% Vendors count with label                             | 80% Vendors count with label                             | Metrics              | .Purchase distribution                     |
| Amount percentage change                                 | [Measures].[Amount percentage change]                                 | Amount percentage change                                 |                                                                                                                                                                                                                                          | IF (<br>    NOT (<br>        ISBLANK ( [Amount Year 1] )<br>    )<br>        && NOT (<br>            ISBLANK ( [Amount Year 2] )<br>        ),<br>    ( ( [Amount Year 1] / [Amount Year 2] ) - 1 )<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Amount percentage change                                 | Amount percentage change                                 | Metrics              | .Purchase distribution                     |
| Amount percentage year 1                                 | [Measures].[Amount percentage year 1]                                 | Amount percentage year 1                                 |                                                                                                                                                                                                                                          | VAR total =<br>    IF (<br>        NOT (<br>            ISBLANK ( [Amount Year 1] )<br>        ),<br>        CALCULATE (<br>            [Amount Year 1],<br>            ALLSELECTED ()<br>        )<br>    )<br>RETURN<br>    IF (<br>        NOT ( ISBLANK ( total ) ),<br>        ( [Amount Year 1] / total )<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Amount percentage year 1                                 | Amount percentage year 1                                 | Metrics              | .Purchase distribution                     |
| Amount Year 1                                            | [Measures].[Amount Year 1]                                            | Amount Year 1                                            |                                                                                                                                                                                                                                          | CALCULATE(<br>SUM('Fact - Purchase distribution'[Amount (Purchase distribution)]),<br>FILTER('Dim - Date (Accounting)',<br>('Dim - Date (Accounting)'[Year]) = ( '.Date parameter - Spend: compare from (Year 1)' )<br>)<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | True               | Amount Year 1                                            | Amount Year 1                                            | Metrics              | .Purchase distribution                     |
| Amount Year 2                                            | [Measures].[Amount Year 2]                                            | Amount Year 2                                            |                                                                                                                                                                                                                                          | CALCULATE(<br>SUM('Fact - Purchase distribution'[Amount (Purchase distribution)]),<br>FILTER('Dim - Date (Accounting)',<br>('Dim - Date (Accounting)'[Year]) = ('.Date parameter - Spend: compare to (Year 2)')<br>)<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | True               | Amount Year 2                                            | Amount Year 2                                            | Metrics              | .Purchase distribution                     |
| General Ledger Accounts Count Year 1                     | [Measures].[General Ledger Accounts Count Year 1]                     | General Ledger Accounts Count Year 1                     |                                                                                                                                                                                                                                          | VAR val =<br>    CALCULATE (<br>        DISTINCTCOUNT ( 'Fact - Purchase distribution'[General Ledger Account Key] ),<br>        FILTER (<br>            'Dim - Date (Accounting)',<br>            ( 'Dim - Date (Accounting)'[Year] ) = ( '.Date parameter - Spend: compare from (Year 1)' )<br>        )<br>    )<br>RETURN<br>    IF ( ISBLANK ( val ), 0, val )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | True               | General Ledger Accounts Count Year 1                     | General Ledger Accounts Count Year 1                     | Metrics              | .Purchase distribution                     |
| General Ledger Accounts Count Year 2                     | [Measures].[General Ledger Accounts Count Year 2]                     | General Ledger Accounts Count Year 2                     |                                                                                                                                                                                                                                          | VAR val =<br>    CALCULATE (<br>        DISTINCTCOUNT ( 'Fact - Purchase distribution'[General Ledger Account Key] ),<br>        FILTER (<br>            'Dim - Date (Accounting)',<br>            ( 'Dim - Date (Accounting)'[Year] ) = ( '.Date parameter - Spend: compare to (Year 2)' )<br>        )<br>    )<br>RETURN<br>    IF ( ISBLANK ( val ), 0, val )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | True               | General Ledger Accounts Count Year 2                     | General Ledger Accounts Count Year 2                     | Metrics              | .Purchase distribution                     |
| Invoices Count Percentage Change                         | [Measures].[Invoices Count Percentage Change]                         | Invoices Count Percentage Change                         |                                                                                                                                                                                                                                          | IF (<br>    NOT (<br>        ISBLANK ( [Invoices Count Year 1] )<br>    )<br>        && NOT (<br>            ISBLANK ( [Invoices Count Year 2] )<br>        ),<br>    ( ( [Invoices Count Year 1] / [Invoices Count Year 2] ) - 1 )<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Invoices Count Percentage Change                         | Invoices Count Percentage Change                         | Metrics              | .Purchase distribution                     |
| Invoices Count Year 1                                    | [Measures].[Invoices Count Year 1]                                    | Invoices Count Year 1                                    |                                                                                                                                                                                                                                          | CALCULATE(<br>DISTINCTCOUNT('Fact - Purchase distribution'[Purchase Invoice Number Key]),<br>FILTER('Dim - Date (Accounting)',<br>('Dim - Date (Accounting)'[Year]) = ('.Date parameter - Spend: compare from (Year 1)')<br>)<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | True               | Invoices Count Year 1                                    | Invoices Count Year 1                                    | Metrics              | .Purchase distribution                     |
| Invoices Count Year 2                                    | [Measures].[Invoices Count Year 2]                                    | Invoices Count Year 2                                    |                                                                                                                                                                                                                                          | CALCULATE(<br>DISTINCTCOUNT('Fact - Purchase distribution'[Purchase Invoice Number Key]),<br>FILTER('Dim - Date (Accounting)',<br>('Dim - Date (Accounting)'[Year]) = ('.Date parameter - Spend: compare to (Year 2)')<br>)<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | True               | Invoices Count Year 2                                    | Invoices Count Year 2                                    | Metrics              | .Purchase distribution                     |
| Legal Entities Count Year 1                              | [Measures].[Legal Entities Count Year 1]                              | Legal Entities Count Year 1                              |                                                                                                                                                                                                                                          | var val =<br>CALCULATE(<br>DISTINCTCOUNT('Fact - Purchase distribution'[Ledger Key]),<br>FILTER('Dim - Date (Accounting)',<br>('Dim - Date (Accounting)'[Year]) = ('.Date parameter - Spend: compare from (Year 1)')<br>  )<br>)<br>return<br>IF( ISBLANK(val), 0, val)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | True               | Legal Entities Count Year 1                              | Legal Entities Count Year 1                              | Metrics              | .Purchase distribution                     |
| Legal Entities Count Year 2                              | [Measures].[Legal Entities Count Year 2]                              | Legal Entities Count Year 2                              |                                                                                                                                                                                                                                          | var val =<br>CALCULATE(<br>DISTINCTCOUNT('Fact - Purchase distribution'[Ledger Key]),<br>FILTER('Dim - Date (Accounting)',<br>('Dim - Date (Accounting)'[Year]) = ('.Date parameter - Spend: compare to (Year 2)')<br>  )<br>)<br>return<br>IF( ISBLANK(val), 0, val)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | True               | Legal Entities Count Year 2                              | Legal Entities Count Year 2                              | Metrics              | .Purchase distribution                     |
| Month Name                                               | [Measures].[Month Name]                                               | Month Name                                               |                                                                                                                                                                                                                                          | CALCULATE (<br>    MIN ( 'Dim - Date (Accounting)'[Month] ),<br>    FILTER (<br>        'Dim - Date (Accounting)',<br>        'Dim - Date (Accounting)'[Date Key]<br>            = MIN ( 'Fact - Purchase distribution'[Accounting Date Key] )<br>    )<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | True               | Month Name                                               | Month Name                                               | Metrics              | .Purchase distribution                     |
| Procurement Categories Count Year 1                      | [Measures].[Procurement Categories Count Year 1]                      | Procurement Categories Count Year 1                      |                                                                                                                                                                                                                                          | CALCULATE(<br>DISTINCTCOUNT('Fact - Purchase distribution'[Procurement Category Key]),<br>FILTER('Dim - Date (Accounting)',<br>('Dim - Date (Accounting)'[Year]) = ('.Date parameter - Spend: compare from (Year 1)')<br>  )<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | True               | Procurement Categories Count Year 1                      | Procurement Categories Count Year 1                      | Metrics              | .Purchase distribution                     |
| Purchase Orders Count Percentage Change                  | [Measures].[Purchase Orders Count Percentage Change]                  | Purchase Orders Count Percentage Change                  |                                                                                                                                                                                                                                          | IF (<br>    NOT (<br>        ISBLANK ( [Purchase Orders Count Year 1] )<br>    )<br>        && NOT (<br>            ISBLANK ( [Purchase Orders Count Year 2] )<br>        ),<br>    ( ( [Purchase Orders Count Year 1] / [Purchase Orders Count Year 2] ) - 1 )<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | True               | Purchase Orders Count Percentage Change                  | Purchase Orders Count Percentage Change                  | Metrics              | .Purchase distribution                     |
| Purchase Orders Count Year 1                             | [Measures].[Purchase Orders Count Year 1]                             | Purchase Orders Count Year 1                             |                                                                                                                                                                                                                                          | CALCULATE(<br>DISTINCTCOUNT('Fact - Purchase distribution'[Purchase Order Number Key]),<br>FILTER('Dim - Date (Accounting)',<br>('Dim - Date (Accounting)'[Year]) = ('.Date parameter - Spend: compare from (Year 1)')<br>)<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | True               | Purchase Orders Count Year 1                             | Purchase Orders Count Year 1                             | Metrics              | .Purchase distribution                     |
| Purchase Orders Count Year 2                             | [Measures].[Purchase Orders Count Year 2]                             | Purchase Orders Count Year 2                             |                                                                                                                                                                                                                                          | CALCULATE(<br>DISTINCTCOUNT('Fact - Purchase distribution'[Purchase Order Number Key]),<br>FILTER('Dim - Date (Accounting)',<br>('Dim - Date (Accounting)'[Year]) = ('.Date parameter - Spend: compare to (Year 2)')<br>)<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | True               | Purchase Orders Count Year 2                             | Purchase Orders Count Year 2                             | Metrics              | .Purchase distribution                     |
| Currency Selected Label                                  | [Measures].[Currency Selected Label]                                  | Currency Selected Label                                  |                                                                                                                                                                                                                                          | IF (<br>    [Single Currency is Selected],<br>    "Single currency",<br>    "Choose currency"<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | True               | Currency Selected Label                                  | Currency Selected Label                                  | Metrics              | .Purchase distribution                     |
| Single Currency is Selected                              | [Measures].[Single Currency is Selected]                              | Single Currency is Selected                              |                                                                                                                                                                                                                                          | AND (<br>    DISTINCTCOUNT ( 'Dim - Currency'[Currency] ) == 1,<br>    SELECTEDVALUE ( 'Dim - Currency'[Currency] ) <> "- Select a currency -"<br>)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | True               | Single Currency is Selected                              | Single Currency is Selected                              | Metrics              | .Purchase distribution                     |
| Vendors Count Year 1                                     | [Measures].[Vendors Count Year 1]                                     | Vendors Count Year 1                                     |                                                                                                                                                                                                                                          | var val = CALCULATE(<br>DISTINCTCOUNT('Fact - Purchase distribution'[Selling Party Key]),<br>FILTER('Dim - Date (Accounting)',<br>('Dim - Date (Accounting)'[Year]) = ('.Date parameter - Spend: compare from (Year 1)')<br>  )<br>)<br>return<br>IF( ISBLANK(val), 0, val)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | True               | Vendors Count Year 1                                     | Vendors Count Year 1                                     | Metrics              | .Purchase distribution                     |
| Vendors Count Year 2                                     | [Measures].[Vendors Count Year 2]                                     | Vendors Count Year 2                                     |                                                                                                                                                                                                                                          | var val = CALCULATE(<br>DISTINCTCOUNT('Fact - Purchase distribution'[Selling Party Key]),<br>FILTER('Dim - Date (Accounting)',<br>('Dim - Date (Accounting)'[Year]) = ('.Date parameter - Spend: compare to (Year 2)')<br>  )<br>)<br>return<br>IF( ISBLANK(val), 0, val)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | True               | Vendors Count Year 2                                     | Vendors Count Year 2                                     | Metrics              | .Purchase distribution                     |
| Year 1 Label                                             | [Measures].[Year 1 Label]                                             | Year 1 Label                                             |                                                                                                                                                                                                                                          | MAX( '.Date parameter - Spend: compare from (Year 1)'[Compare from (Year 1)] ) & " (Year 1)"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | True               | Year 1 Label                                             | Year 1 Label                                             | Metrics              | .Purchase distribution                     |
| Year 2 Label                                             | [Measures].[Year 2 Label]                                             | Year 2 Label                                             |                                                                                                                                                                                                                                          | MAX( '.Date parameter - Spend: compare to (Year 2)'[compare to (Year 2)] ) & " (Year 2)"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Year 2 Label                                             | Year 2 Label                                             | Metrics              | .Purchase distribution                     |
| Amount percentage year 2                                 | [Measures].[Amount percentage year 2]                                 | Amount percentage year 2                                 |                                                                                                                                                                                                                                          | VAR total =<br>    IF (<br>        NOT (<br>            ISBLANK ( [Amount Year 2] )<br>        ),<br>        CALCULATE (<br>            [Amount Year 2],<br>            ALLSELECTED ()<br>        )<br>    )<br>RETURN<br>    IF (<br>        NOT ( ISBLANK ( total ) ),<br>        ( [Amount Year 2] / total )<br>    )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | True               | Amount percentage year 2                                 | Amount percentage year 2                                 | Metrics              | .Purchase distribution                     |
